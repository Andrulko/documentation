# Tangle stream processing with Apache Flink

**_Note:_** The tangle streaming libraries used in this guide are not recommended for production environments.
Feel free to contribute to the libraries, so that they eventually become production ready.

[Apache Flink](https://flink.apache.org/) is an open source stream processing framework.
This guide describes how you can connect Flink to the IOTA tangle.

## Requirements

Operation system: Linux, MacOS, BSD or Windows
Memory: Minimum of 2GB
Storage: Minimum of 10GB of free space

### Notice on Java

This guide the Scala programming language. If you consider yourself as beginner, you should stick to Scala.
If you want to use Scala in Java, you have to add the [Scala library to maven or sbt](https://mvnrepository.com/artifact/org.scala-lang/scala-library).
sbt can also be used with Java. [This guide](http://xerial.org/blog/2014/03/24/sbt/) might be useful to get sbt running along with Java. 
The [Artima guide](https://www.artima.com/pins1ed/combining-scala-and-java.html) describes how you can use Scala in Java. 


### What data are available?

Since the [Flink tangle source library](https://github.com/Citrullin/flink-tangle-source) uses the ZMQ API, all
[ZMQ events](https://docs.iota.org/docs/iri/0.1/references/zmq-events) are therefore also available in Flink.
The Flink streaming library uses the [ZeroMQMessageParser](https://github.com/Citrullin/tangle-streaming/blob/master/src/main/scala/org/iota/tangle/stream/ZeroMQMessageParser.scala)
from the [Tangle streaming library](https://github.com/Citrullin/tangle-streaming) to parse the raw event messages into class instances.
All ZMQ event messages are wrapped in classes generated by the [protobuf schema files](https://github.com/Citrullin/tangle-streaming/tree/master/src/main/protobuf).
All defined protobuf defined messages and attributes are also available within Flink.

## 1. Install Java >=8

**_Notice:_** Since Oracle Java is not free of charge for business environments anymore, 
you might consider to use OpenJDK instead.

Since Scala uses the jvm, we need to install Java 8 or higher, to be able to use Scala.

[OpenJDK Installation guide](http://openjdk.java.net/install/)
[Oracle Java JDK Installation guide](https://docs.oracle.com/javase/8/docs/technotes/guides/install/install_overview.html)


## 2. Install sbt

Follow [this guide](https://www.scala-sbt.org/1.x/docs/Setup.html) to install sbt.

## 3. Build libraries

Since the libraries are not supposed to be used in production environments, you cannot find them in any official
repository. You have to build and publish them locally.
You have to clone the following repositories:

**Tangle streaming:**
```bash
git clone https://github.com/Citrullin/tangle-streaming.git
```
**Flink Tangle source**
```bash
git clone https://github.com/Citrullin/flink-tangle-source
```

After cloning you have to build & publish the repositories:

```bash
cd tangle-streaming && sbt
```

The sbt repl initializes. That can take a moment. When the initialization is done, execute the following command within
the repl.

```bash
compile
publishLocal
```

When you are done, press CTRL + C to terminate the repl.

```bash
cd ../flink-tangle-source && sbt
```

Same as before, after initialization, execute the following again.

```bash
compile
publishLocal
```

### 4. Add dependencies to build.sbt


